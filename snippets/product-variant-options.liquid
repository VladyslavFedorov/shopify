{% comment %}
  Renders product variant options

  Accepts:
  - product: {Object} product object.
  - option: {Object} current product_option object.
  - block: {Object} block object.


  Usage:
  {% render 'product-variant-options',
    product: product,
    option: option,
    block: block
  %}
{% endcomment %}
{%- liquid
  assign variants_available_arr = product.variants | map: 'available'
  assign variants_option1_arr = product.variants | map: 'option1'
  assign variants_option2_arr = product.variants | map: 'option2'
  assign variants_option3_arr = product.variants | map: 'option3'

  assign product_form_id = 'product-form-' | append: section.id
-%}

{%- for option in product.options_with_values -%}
  <div class="product-form__input product-form__input--dropdown">
    <label class="form__label" for="Option-{{ section.id }}-{{ forloop.index0 }}">
      {{ option.name }}
    </label>
    <div class="select">
      <select
        id="Option-{{ section.id }}-{{ forloop.index0 }}"
        class="select__select"
        name="options[{{ option.name | escape }}]"
        form="{{ product_form_id }}"
      >
        {%- for value in option.values -%}
          {%- assign variant = product.variants | where: 'title', value | first -%}
          <option
            value="{{ value | escape }}"
            data-inventory-quantity="{{ variant.inventory_quantity }}"
            {% if option.selected_value == value %}
              selected="selected"
            {% endif %}
          >
            {% if option_disabled -%}
              {{- 'products.product.value_unavailable' | t: option_value: value -}}
            {%- else -%}
              {{- value -}}
            {%- endif %}
          </option>
        {%- endfor -%}
      </select>
      {% render 'icon-caret' %}
    </div>
  </div>
{%- endfor -%}
<script>
  // Отримати елемент селекта
  const selectElement = document.getElementById('Option-{{ section.id }}-{{ forloop.index0 }}');

  // Отримати елемент для виведення Available Quantity
  const availableQuantityElement = document.getElementById('available-quantity');

  // Додати обробник подій на зміну значення селекта
  selectElement.addEventListener('change', (event) => {
    // Отримати обрану опцію
    const selectedOption = event.target.selectedOptions[0];
    
    // Отримати значення кількості доступного товару з атрибуту data-available-quantity
    const availableQuantity = selectedOption.dataset.availableQuantity;

    // Вивести кількість доступного товару у відповідний елемент HTML
    availableQuantityElement.textContent = `Available Quantity: ${availableQuantity}`;
  });
</script>
